<!DOCTYPE html>
<html>
<head>
    <title>Interrupts</title>
    <link rel="stylesheet" href="/css/styles.css"/>
    <link rel="stylesheet" href="/css/prism.css"/>
    <!-- Add any necessary CSS and JavaScript files -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <nav class="navbar">    <!--See .navbar in styles.css-->
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="#">Our team</a></li>
          <li><a href="#">Projects</a></li>
          <li><a href="#">Contact</a></li>
          <li>
            <form>
                <input type="search" name="q" placeholder="Search site" />
                <input type="submit" value="Go!" />
            </form>
           </li>
        </ul>
    </nav>

    <aside class="sidebar">   <!-- Sidebar -->
        <a href="#what">What is interrupt</a>
        <a href="#flow">Interrupt Flow</a>
        <a href="#ivt">Interrupt Vector Table</a>
        <ul>
            <li><a href="#probing">Probing</a></li>
        </ul>
    </aside>

    <article style="margin-left:200px;">
        <h2 id="what">What is Interrupt</h2>
        <dl>
            Interrupt is <b>event/signals generated by H/W(Eg: clock, keyboard) or S/W which is sent to CPU</b> by Interrupt Controller.<br>
            Interrupts are used to handle asynchronous events, CPU pauses the current execution, address the event, and then resume its previous activity.<br>
            CPU is asked to perform some high priority task wrt what its doing.<br>
            Interrupts can be triggered by hardware devices (hardware interrupts) or by software instructions (software interrupts).<br>
            Information from interrupt is converted to character and stored in buffer to be later used by ISR.
        </dl>

        <h2 id="flow">Interrupt Flow/Hardware Interrupt reaching CPU</h2>
        <table class="image-table">
            <tr>
                <td>
                    <div class="image-container">
                        <img 
                      src="//www.plantuml.com/plantuml/png/XP91ZzCm48Nl_XN3Se43uju3MbGaL2r2LNUNqrvSUvGEYSTcF0w4Nu_TBTkagEAMp7nlvirBRhDQqH86yog9xO85nVWRL0gQL3laA5bMUCmeO3EKHVKEftsqujUHLU8mF3EzMq0tMucTs13iVa1uuWqhYfIaS9RTD5sY2-5w-rZnhmyxs18V4PVA4daPziJVq6cKXxRboDAeLzbxb94Sxc9HuXEUnHYEYX1752ZmUZrPDccm4t478Ow41jb3O-QaIvNzGjr1FmlY_nMpsOAvneKJH8R-bELCKU3TXvhcgkKCHnYzwLsh9ghbm_kVG7-FcY-eNJXvIiIzyUZ88oIXAAIJ-PWpTNpMmdZCphmfJ3yAmkRJsvcDH6rbk_DovJA4HGfRMp8-Pm0jaRrr_MncvTjC6dNrZmqWRshZPUVcVdSMP5d1zn9I1etj3QptBPcPbrQjPkuEjYTJnO2_q1MboE1YI0FguhDSlw7-Vo2OIy1ihbvoMnzB6Fu0"
                      alt="Interrupt flow" class="zoomable-image" id="zoomableImage1">
                    </div>
                </td>
                <td>
                    <div class="image-container">
                    <img src="/images/Interrupts/interrupt_flow.jpg" alt="Interrupt flow1" class="zoomable-image" id="zoomableImage2">
                    </div>                    
                </td>
            </tr>
        </table>

        <h2 id="ivt">IVT(Interrupt Vector Table) / (IDT) Interrupt Descriptor Table</h2>
        <dl>
        Contains ISR(Interrupt service routine)/Handler Address to which CPU jumps at occurrence of interrupt. 
        Present in 1st 1K of physical memory.<br>
        Starting address of IVT is stored in dedicated register (IDTR).<br>
        IVT is created when the system initially boots and reflects the specific system configuration.<br>
        IVT is filled using <b><a href="#probing">Probing</a></b><br>
        Interrupt number is used as index in IVT. CPU goes to IVT's index, gets Instruction Pointer/Program counter and starts 
        Interrupt service procedure. Once CPU starts ISP, Device Acks Interrupt controller
        </dl>
        <pre><code class="language-css">
            | 0x420932 ISR of Int0 |      |     |     |
Interrupt No>       0                 1       2     3

    CPU                    Hardware_Device
       <- Interrupt3=signal-
 Find & runs ISR3 for Intr3
    isr3(){..}
        </code></pre>

        <h4 id="probing">Probing</h4>
        <dl>
        Finding which Interrupt line Hardware Device is going to use?<br>
        Device driver tells the Hardware device to generate interrupts and watches the IRQ line and 
        finds which line device is using.<br>
        <pre><code class="language-css">
            unsigned long probe_irq_on(void);
        </code></pre>
        This function returns a bit maskof unassigned interrupts.<br>
        The driver must preserve the returned bit mask, and pass it to probe_irq_off later.<br>
        Other Method? The interrupt handler can be installed either at driver initialization or when the device 
        is first opened. Installing isr at device initialization causes interrupt line to be occupied even device is not used.
        </dl>

    </article>

    <script src="/scripts/common.js"></script>
    <script src="/scripts/prism.js"></script>
</body>
</html>
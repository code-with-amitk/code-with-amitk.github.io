<!DOCTYPE html>
<html>
<head>
    <title>decltype</title>
    <link rel="stylesheet" href="/css/styles.css"/>
    <link rel="stylesheet" href="/css/prism.css"/>
</head>
<body>
    <nav class="navbar">    <!--See .navbar in styles.css-->
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="#">Our team</a></li>
          <li><a href="#">Projects</a></li>
          <li><a href="/contact.html">Contact</a></li>
          <li>
            <form>
                <input type="search" name="q" placeholder="Search site" />
                <input type="submit" value="Go!" />
            </form>
           </li>
        </ul>
    </nav>

    <aside class="sidebar">    <!--See .sidebar in styles.css-->
        <a href="#what">What</a>
        <a href="#var">Variable declaration using decltype</a>
        <ul>
            <li><a href="#char">char, int</a></li>
            <li><a href="#lambda">lambda</a></li>
            <li><a href="#template">Template</a></li>
        </ul>
        <a href="#auto">decltype auto</a>
    </aside>

    <article style="margin-left:200px;">
        <h2 id="what">What is decltype</h2>
        <dl>
            Inspects the type of an entity/expression.<br>
            <b>Why use decltype?</b> <br>
            &ensp; When declaring types that are difficult or impossible to declare using standard notation, 
            like lambda-related types or types that depend on template parameters.
        </dl>
        <dl><b>SYNTAX?</b></dl>
        <pre><code>
decltype ( expression )         //Since C++11
decltype ( type )               //Since C++11
        </code></pre>

        <h2 id="var">Variable declaration using decltype</h2>

        <h3 id="char">1. char,int variable</h3>
        <pre><code class="language-css">
#include &lt;iostream>
int main(){
    char c;
    decltype(c) c1 = 10;
    std::cout &lt;&lt; c1;                     //10
    std::cout &lt;&lt; typeid(c1).name();      //char

    int a;
    decltype(a) b = 10;
    std::cout &lt;&lt; typeid(b).name();      //int
}
        </code></pre>

        <h3 id="lambda">2. Lambda</h3>
        <pre><code class="language-css">
#include &lt;iostream>
int main(){
    auto f = [](int a, int b)->int {
        return a*b;
    };
    decltype(f) c = f;
    std::cout &lt;&lt; typeid(c).name();                //int
    std::cout &lt;&lt; c(2,3);                          //6
}
        </code></pre>

        <h3 id="template">3. Template Variable</h3>
        <pre><code class="language-css">
template &lt;typename T>
T add(T a, T b) {
    return a + b;
}

template &lt;typename T, typename U>
auto add1(T a, U b) -> decltype(a + b) {
    return a + b;
}

int main() {
    decltype(add(2, 3)) a = 1;
    decltype(add(2.1, 3.1)) b = 2.3;
    cout &lt;&lt; typeid(a).name() &lt;&lt; "\n";       //int
    cout &lt;&lt; a + b &lt;&lt; "\n";                  //3.3

    decltype(add1(2, 1.1)) c = 3;
    cout&lt;&lt;<< typeid(c).name() &lt;&lt; "\n";       //double
}
        </code></pre>

        <h2 id="auto">decltype auto</h2>
        <h4>auto vs decltype(auto)</h4>
            <dl>
            auto does not deduces the type correctly, decltype(auto) does.
            </dl>
        <table>
            <tr>
                <th></th>
                <th>auto</th>
                <th>decltype</th>
            </tr>
            <tr>
                <td>cv-qualifiers(const, volatile)</td>
                <td>
                    auto does not keep cv qualifiers
                    <pre><code class="language-css">
int main() {
    const int a = 10;
    auto a1 = a;
    cout &lt;&lt; typeid(a1).name() &lt;&lt; "\n";      //int
}
                    </code></pre>
                </td>
                <td>
                    decltype keeps the cv qualifiers
                    <pre><code class="language-css">
int main() {
    const int a = 10;
    decltype(auto) a1 = 2;
    if (is_same &lt;int&, decltype(d)>::value) {
        cout &lt;&lt; "yes";                            // yes
    }
    cout &lt;&lt; typeid(a1).name() &lt;&lt; "\n";      //const int
}
                    </code></pre>
                </td>
            </tr>
            <tr>
                <td>int&</td>
                <td>
                    <pre><code class="language-css">
int y = 0;
int& y1 = y;
auto y2 = y1;           //y2 is int
                    </code></pre>
                </td>
                <td>
                    <pre><code class="language-css">
int y = 0;
int& y1 = y;
decltype(auto) y2 = 1;                    //y is int&
if (is_same &lt;int&, decltype(y2)>::value) {
    cout &lt;&lt; "yes";                            // yes
}
                    </code></pre>
                </td>
            </tr>

            <tr>
                <td>int&& (R value reference)</td>
                <td>
                    <pre><code class="language-css">
int main() {
    int&& a = 0;    //R value reference
    auto a1 = move(a);
    cout &lt;&lt; typeid(a1).name() &lt;&lt; "\n";      //int
    if (is_same &lt;decltype(a1), int&&>::value) {
        cout &lt;&lt; "yes";
    } else {
        cout &lt;&lt; "No";
    }
}
/*
Output:
No
*/
                    </code></pre>
                </td>
                <td>
                    <pre><code class="language-css">
int main() {
    int &&a = 0;
    decltype(auto) a2 = move(a);
    cout &lt;&lt; typeid(a1).name() &lt;&lt; "\n";      //int &&
    if (is_same &lt;decltype(a2), int&&>::value)
        cout &lt;&lt; "yes";
    else
        cout &lt;&lt; "no";
}
/*
Output:
yes
*/
                    </code></pre>
                </td>
            </tr>

            <tr>
                <td>Function Return type</td>
                <td>
                    <pre><code class="language-css">
auto fun (int &i) { // Function return type is int&, but auto returned int
    return i;
}
int main() {
    int a = 1;
    if (is_same &lt;decltype(fun(a)), int&>::value) {
        cout &lt;&lt; "yes" &lt;&lt; endl;
    } else {
        cout &lt;&lt; "no" &lt;&lt; endl;
    }
}
/*
Output:
No
*/
                    </code></pre>
                </td>
                <td>
                    <pre><code class="language-css">
decltype(auto) fun1 (int &i) {
    return i;
}
int main() {
    auto a2 = fun1(a);
    if (is_same &lt;decltype(a2), int&>::value) {
        cout &lt;&lt; "yes";
    }
}
/*
Output:
yes
*/
                    </code></pre>
                </td>
            </tr>
        </table>
    </article>



    <script src="/scripts/prism.js"></script>
</body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <title>Terms</title>
    <link rel="stylesheet" href="/css/styles.css"/>
    <link rel="stylesheet" href="/css/prism.css"/>
  </head>

<body>
  <nav class="navbar">    <!--See .navbar in styles.css-->
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="#">Our team</a></li>
      <li><a href="#">Projects</a></li>
      <li><a href="/contact.html">Contact</a></li>
      <li>
        <form id="searchForm">
            <input type="search" id="searchInput" name="q" placeholder="Search site" />
            <input type="submit" value="Go!" />
        </form>
        </li>
    </ul>
  </nav>

  <aside class="sidebar">
    <a href="#jwt">Json Web Token</a>
    <a href="#authenticatetorestful">Authenticate to RESTFul APIs</a>
  </aside>

  <main style="margin-left:200px;">
    <h2 id="jwt">Json Web Token / oauth_token / auth_token</h2>
    <dl><strong>Usage?</strong></dl>
    <dt>For authentication on the web, ie authentication to RESTFul APIs
        They are used to securely transmit information between parties as a JSON object.<br>
        JWTs consist of three parts: [header + payload + signature].
        These parts are concatenated together with dots to form the token
    </dt>

    <br>
    <dl><strong>How JWTs are used for authentication</strong></dl>
    <pre class="mermaid">
        sequenceDiagram
            rect rgb(236, 232, 242)
            participant dns as DNS
            participant cdn as CDN
            participant ub as User-Browser
            box AWS
            participant lb as LoadBalancer
            participant as as Application Server<br>RESTFul Service
            participant auth as Auth_Service
            end
            participant idp as IDP

            note over ub: HTTP GET test.com
            ub ->> dns: IP of test.com
            dns ->> ub: IP of CDN
            ub ->> cdn: HTTP GET test.com
            cdn ->> ub: Home Page
            note over ub: User enters username,pass
            ub ->> lb: HTTP GET test.com(user,pass)
            lb ->> as: HTTP GET test.com(user,pass)
            as ->> ub: HTTP Redirect http://auth_svc

            ub ->> auth: http://auth_svc?user?pass
            auth ->> idp: ?user?pass
            idp ->> auth: SAML Assertion(Authenticated)
            auth ->> ub: JWT Token(Json Object)

            note over auth:JWT=(header + payload(username) <br>+ signature(Digital signature of payload))
            note over ub: Stores JWT in cookie or cache
            ub ->> as: CRUD(header(bearer token=JWT) + Body)

            note over as: JWT expiry in 5 hours<br>Reissue JWT
        end

    </pre>

    <h2 id="authenticatetorestful">Authenticate to RESTFul APIs</h2>
    <dl><strong><a href="#jwt">JWT(Json Web Token)</a></strong></dl>
    <pre class="mermaid">
        sequenceDiagram
        rect rgb(221, 240, 221)
            participant u as UserApp
            participant cdn as CDN
            box AWS
            participant cog as Amazon-Cognito<br>User,Pass store
            participant s3 as Amazon-S3
            end

            s3 ->> cdn: HTML, css, javascript etc
            note over u: Open www.test.com
            u ->> cdn: GET test.com
            cdn ->> u: HTML, css, javascript etc

            note over u: Enter email, username, password<br>Submit.
            u ->> cog: user,password,email
            cog ->> u: Send Confirmation Code to Inbox

            note over u: User enter code on test.com<br>User signs in
            note over u: Javascript function in browser <br>communicate with cognito
            u ->> cog: Authenticate using <br>Secure Remote Password protocol (SRP)
            cog ->> u: JWT(JSON Web Token)
            note over u: JWT would be used by <br>to communicate with RESTful APIs
        end
    </pre>

  </main>

  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.esm.min.mjs';
  </script>	
</body>
</html>
